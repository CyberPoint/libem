<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EM: libGaussMix++: An Expectation Maximization Algorithm for Training Gaussian Mixture Models</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>libGaussMix++: An Expectation Maximization Algorithm for Training Gaussian Mixture Models</h1><h3>v1.0 </h3><h2><a class="anchor" id="intro_sec">
Introduction</a></h2>
<p>A Gaussian mixture model is method of approximating, as a linear combination of multivariate Gaussian density functions, an unknown density function from which a given data set is presumed to be drawn. The means and covariance matrices of these Gaussian densities are sometimes referred to as the "hidden" parameters of the data set.</p>
<p>Expectation Maximization (EM) is perhaps the most popular technique for discovering the parameters of a mixture with an a priori given number of components. Here's the usual scenario: one is given a set of N data points in an M-dimensional space. One seeks to fit to the data a set of K multivariate Gaussian distributions (or "clusters") that best represent the observed distribution of the data points, where K is specified, but the means and covariances of the Gaussians are unknown. The desired output includes the means and covariances of the Gaussians, along with the cluster weights (coefficients of the linear combination of Gaussians). One may think of the data as being drawn by first randomly choosing a particular Gaussian according to the cluster weights, and then choosing a data point according to the selected distribution. The overall probability density assigned to a point is then given by the sum over k of P(n|k)P(k) where k denotes the cluster, P(k) its probability, and P(n|k) denotes the probability density of the point given the cluster. The likelihood density L of the data is the product of these sums, taken over all data points (which are assumed to be independent and identically distributed). The EM algorithm produces an estimate of the P(k) and the P(n|k), by attempting to maximize L. Specifically, it yields the estimated means mu(k), covariance matrices sigma(k), and weights P(k) for each Gaussian.</p>
<p>An overall outline of the EM calculations is best described by working backwards from L. Since the data points are (assumed) to be independent, L is the product of the probability densities of each observed data point, which splits into a contribution P(n|k) from each Gaussian (these constributions are sometimes called the point "mixture weights"). In the language of EM, the L and P(n|k) calculations, given known mu(k), sigma(k), and P(k), comprise the algorithm's "expectation step", or E step. Now if the P(n|k)'s are known, we can derive from them maximum likelihood estimates of the mu(k), sigma(k), and P(k), in a process called the "maximization step", or M step, from which we then obtain new (better) P(n|k).</p>
<p>The power of the EM algorithm comes from a theorem (see the first reference) stating that, starting from any reasonable guess of parameter values, an iteration of an E step followed by an M step will always increase the likelihood value of L, and that repeated iterations between these two steps will converge to (at least) a local maximum. Often, the convergence is indeed to the global maximum. The EM algorithm, in brief, goes like this:</p>
<ul>
<li>Guess starting values for the mu(k), sigma(k) and P(k) for each Gaussian,</li>
<li>Repeat: an E step to get a new L and new P(n|k)s, followed by an M step to get new mu(k)s, sigma(k)s, and P(k)s,</li>
<li>Stop when the value of L is no longer meaningfully changing.</li>
</ul>
<p>The libGaussMix++ implementation of the EM algorithm uses the "KMeans" clustering algorithm to provide the initial guesses for the means of the K Gaussians, in order to increase the efficiency and efficacy of EM.</p>
<p>One important detail to note is that often, the values of the Gaussian density function will be so small as to underflow to zero. Therefore, it is very important to work with the logarithms of these densities, rather than the densities themselves. This particular implementation works in log space in an attempt to avoid this issue.</p>
<h2><a class="anchor" id="usage_sec">
Usage</a></h2>
<p>libGaussMix++ does not actually build as a library. The main training algorithm is provided in <a class="el" href="EM__Algorithm_8h.html" title="Function prototypes for EM algorithm routines.">EM_Algorithm.h</a>/ <a class="el" href="EM__Algorithm_8cpp.html" title="core libGaussMix++ em algorithm method implementations.">EM_Algorithm.cpp</a>. It uses helper routines provided in <a class="el" href="Matrix_8h.html" title="Definitions for a Matrix class wrapping lapack/blas matrix routimes.">Matrix.h</a>/ <a class="el" href="Matrix_8cpp.html">Matrix.cpp</a> which in turn wraps LAPACK linear algebra functions. To build these files into an executable with a sample driver function provided in <a class="el" href="sample__main_8cpp.html" title="sample main file to show exercise of EM routines.">sample_main.cpp</a>, follow these steps:</p>
<ul>
<li>1. Install BLAS and LAPACK on your machine if they're not already there (c.f. <a href="http://www.netlib.org/lapack/,">http://www.netlib.org/lapack/,</a> which bundles a reference vesion of BLAS).</li>
<li>2. Update the environment variables in the libGaussMix++ makefile to point to your environment's BLAS and LAPACK header and library locations.</li>
<li>3. run make on the libGaussMix++ makefile.</li>
<li>4. run the resulting executable via: "em_algorithm &lt;data_file&gt; &lt;num_dimensions&gt; &lt;num_data_points&gt; &lt;num_clusters&gt;". <br/>
 Try using one of the sample *.csv or *.svm data files as the first argument: e.g. "em_algorithm multid_data_1.csv 3 20 2".</li>
</ul>
<p>The libGaussMix++ has been built and tested on SL6.2 using gcc 4.4.5.</p>
<h2><a class="anchor" id="example_sec">
Caller Example</a></h2>
<p>For an example "main" that will run EM, see <a class="el" href="sample__main_8cpp.html" title="sample main file to show exercise of EM routines.">sample_main.cpp</a>.</p>
<h2><a class="anchor" id="Data">
Formats</a></h2>
<p>libGaussMix++ supports csv and svm-style data formats (c.f. www.csie.ntu.edu.tw/~cjlin/libsvm/). Sample files (multid_data_1.csv and multid_data_2.svm, respectively) are provided for convenience. The former consists of 20 three-dimensional data points falling into two clusters centered on (1,1,1) and (100,100,100). The second is similarly distributed, with a "+1" cluster centered on (10,10,10) and "-1" cluster centered on (50,50,50).</p>
<h2><a class="anchor" id="References">
References</a></h2>
<p>Numerical Recipes 3rd Edition: The Art of Scientific Computing, Cambridge University Press New York, NY, USA Â©2007, ISBN:0521880688 9780521880688 (c.f. chapter 16).</p>
<p>Douglas A. Reynolds, et. al., "Speaker Verication Using Adapated Gaussian Mixture Models," Digital Signal Processing 10, 19-24 (2000). </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 8 Oct 2012 for EM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
